```sql

---SYNTAX:- CREATE DATABASE [DATABASE NAME]

CREATE DATABASE [AUG WEEKEND MORNING]

---SYNTAX:- CONNECTING TO DATABASE--- USE `[DATABASE NAME]`

USE [AUG WEEKEND MORNING]

---------------------------------------

/*
--SYNTAX:-

CREATE TABLE [TABLE NAME]
(
[COLUMN NAME][DATATYPE],
[COLUMN NAME][DATATYPE],
[COLUMN NAME][DATATYPE],
.
.
[COLUMN NAME N][DATATYPE]
)

*/


CREATE TABLE [CUSTOMER ACCOUNT DETAILS]
(
ACCOUNT_NUMBER INT,
[CUSTOMER-NAME] NVARCHAR(50),
[ACCOUNT BALANCE] MONEY
)


/*
INSERTING THE DATA INTO  TABLE

INSERT INTO [TABLE NAME] VALUES
(ROW 1),
(ROW 2),
(ROW  3)

*/


INSERT INTO [CUSTOMER ACCOUNT DETAILS] VALUES
(125478,'JOHN',52000),
(258963,'ANDREEA',25000),
(9874563,'ERMAN',15000),
(36589,'HUNKAR',65000)

---DQL DATA QUERY LANGUAGE
---SYNTAX:- SELECT * FROM [TABLE NAME]

SELECT * FROM [CUSTOMER ACCOUNT DETAILS]

SELECT ACCOUNT_NUMBER, [ACCOUNT BALANCE]
FROM [CUSTOMER ACCOUNT DETAILS]

--- GIVES INFO ABOUT ABOUT METADATA OF TABLE
---SP_HELP '[TABLE NAME]'

EXEC SP_HELP '[CUSTOMER ACCOUNT DETAILS]'


-----------------------------------------------
---INSERTING THE DATA FOR SPECIFIC RECORDS

/*
INSERT INTO [TN][CN,CN,CN...CN(N)] VALUES
(ROW 1),
(ROW 2),
(ROW 3),
.
.
.
(ROW N)

*/
 SELECT * FROM [CUSTOMER ACCOUNT DETAILS]

 INSERT INTO [CUSTOMER ACCOUNT DETAILS] (ACCOUNT_NUMBER,[CUSTOMER-NAME])
 VALUES (258965,'HARISH'),(74125,'RAKESH')
----------------------
/*
---CONSTRAINTS 2 TYPES
1.COLUMN LEVEL
2.TABLE LEVEL (COMPOSITE KEY)

NOT NULL
DEFAULT
CHECK
UNIQUE
PRIMARY KEY
FOREIGN KEY
*/

CREATE TABLE [CUSTOMER ACCOUNT DETAILS1]
(
ACCOUNT_NUMBER INT UNIQUE NOT NULL,
[CUSTOMER-NAME] NVARCHAR(50) NOT NULL,
[ACCOUNT BALANCE] MONEY NOT NULL
)

INSERT INTO [CUSTOMER ACCOUNT DETAILS1] VALUES
(125478,'JOHN',52000),
(258963,'ANDREEA',25000),
(9874563,'ERMAN',15000),
(36589,'HUNKAR',65000)


SELECT * FROM [CUSTOMER ACCOUNT DETAILS1]


 INSERT INTO [CUSTOMER ACCOUNT DETAILS1]
 VALUES (256985,'HARISH',256985)

----------------------------------------------
/*
UNIQUE KEY
NOT NULL
CHECK
DEFAULT
PRIMARY KEY
FOREIGN KEY

*/

SELECT LEN('GOOGLE')

CREATE TABLE DRIVING_LICENSE
(
DLID VARCHAR(50) UNIQUE NOT NULL,
NAMES VARCHAR(50) NOT NULL,
AGE TINYINT CHECK(AGE>=18) NOT NULL,
MOBILE BIGINT CHECK(LEN(MOBILE)=10) NOT NULL,
EXPIRATION_DATE DATE NOT NULL,
ADDRESS_DETAILS VARCHAR(250) DEFAULT('BENGALURU')NOT NULL
)


INSERT INTO DRIVING_LICENSE VALUES
('A1254UTED','JOHN',23,9966404030,'2045-06-28','DELHI'),
('LKI976HY7','ERMAN',28,8887776655,'2038-12-15','MYSORE')


SELECT * FROM DRIVING_LICENSE


---select  GETDATE()

--select DATEADD(YEAR, 1, GETDATE())

CREATE TABLE DRIVING_LICENSE2
(
    DLID VARCHAR(50) UNIQUE NOT NULL,
    NAMES VARCHAR(50) NOT NULL,
    AGE TINYINT CHECK(AGE >= 18) NOT NULL,
    MOBILE VARCHAR(10) CHECK(LEN(MOBILE) = 10) NOT NULL,
    EXPIRATION_DATE DATE DEFAULT (DATEADD(YEAR, 10, GETDATE())) NOT NULL,
    ADDRESS_DETAILS VARCHAR(250) DEFAULT 'BENGALURU' NOT NULL
);
INSERT INTO DRIVING_LICENSE2 (DLID, NAMES, AGE, MOBILE, ADDRESS_DETAILS) VALUES
('A1254UTED', 'JOHN', 23, '9966404030', 'DELHI'),
('LKI976HY7', 'ERMAN', 28, '8887776655', 'MYSORE')



SELECT * FROM DRIVING_LICENSE


INSERT INTO DRIVING_LICENSE VALUES
('LOI098654','HUNKAR',27,9786199552,'2045-05-31','PUNE')


SP_HELP 'DRIVING_LICENSE'


------------------------------------

CREATE TABLE DL
(
DLID            VARCHAR(50) UNIQUE NOT NULL,
NAMES           VARCHAR(50) NOT NULL,
AGE             TINYINT CHECK(AGE>=18) NOT NULL,
MOBILE          BIGINT CHECK(LEN(MOBILE)=10) NOT NULL,
EXPIRATION_DATE DATE NOT NULL,
ADDRESS_DETAILS VARCHAR(250) DEFAULT('BENGALURU')
)


INSERT INTO DL(DLID
			   ,NAMES
			   ,AGE
			   ,MOBILE
			   ,EXPIRATION_DATE) VALUES
			   ('GFFD787554HG','JAKE',35,9866027219,'2030-05-25')

SELECT * FROM DL

INSERT INTO DL VALUES
('JKJG5443G','ANDREEA',29,9966505030,'2033-12-05',NULL)

---------------------------------

/*
PRIMARY KEY
FOREIGN KEY
*/

CREATE TABLE [HDFC ACCOUNT DETAILS]
(
[ACCOUNT-NUMBER] INT PRIMARY KEY,
CUSTOMER_NAME VARCHAR(50) NOT NULL,
[PAN ID] VARCHAR(12) CHECK(LEN([PAN ID])=12) UNIQUE NOT NULL,
[MOBILE NUMBER] BIGINT CHECK(LEN([MOBILE NUMBER])=10)
)

SELECT * FROM [HDFC ACCOUNT DETAILS]



INSERT INTO [HDFC ACCOUNT DETAILS] VALUES
(2506860,'ERMAN','HGGF2365HGGR',9966402020),
(3256980,'HUNKAR','LKIO1456QWER',9988776655),
(132245674,'LOUIS','FGHJ8745ASSD',9848448240)

SELECT * FROM [HDFC ACCOUNT DETAILS]
SELECT * FROM [HDFC TRANSACTION DETAILS]

CREATE TABLE [HDFC TRANSACTION DETAILS]
(
ACCOUNT_ID INT FOREIGN KEY REFERENCES [HDFC ACCOUNT DETAILS]
([ACCOUNT-NUMBER]),
TRANSACTION_ID INT UNIQUE NOT NULL,
[DATE] DATETIME NOT NULL,
AMOUNT MONEY,
[STATUS] CHAR(2) CHECK ([STATUS] IN ('CR','DR')) NOT NULL,
EMAIL VARCHAR(50) FOREIGN KEY REFERENCES [CUSTOMER PERSONAL DETAILS] (EMAIL)
)


INSERT INTO [HDFC TRANSACTION DETAILS] VALUES
(2506860,125478012,'2023-08-12 11:32:28',500,'CR','ERMAN@MICROSOFT.COM'),
(2506860,147852036,'2023-08-12 16:45:26',100,'DR','ERMAN@MICROSOFT.COM'),
(2506860,78965400,'2023-08-12 18:33:21',5000,'DR','ERMAN@MICROSOFT.COM')

SELECT * FROM [HDFC TRANSACTION DETAILS]


INSERT INTO [HDFC TRANSACTION DETAILS] VALUES
(2506860,1254012,'2023-08-12 11:32:28',500,'dr')

--select * from [database].[dbo].[tablename]

CREATE TABLE [CUSTOMER PERSONAL DETAILS]
(

CUSTOMER_NAME VARCHAR(50) NOT NULL,
EMAIL VARCHAR(50) PRIMARY KEY ,
PHONE_NUMBER BIGINT CHECK(LEN(PHONE_NUMBER)=10) NOT NULL,
ACCOUNT_NUMBER INT
FOREIGN KEY REFERENCES [HDFC ACCOUNT DETAILS] ([ACCOUNT-NUMBER])
)


SELECT *  FROM [CUSTOMER PERSONAL DETAILS]

INSERT INTO [CUSTOMER PERSONAL DETAILS] VALUES
('HUNKAR','HUNKAR@GOOGLE.COM',9960002020,3256980)



---DROP TABLE [TABLE NAME]

DROP TABLE [DBO].[HDFC TRANSACTION DETAILS]


------------------TABEL LEVEL CONSTRAINT------------

CREATE TABLE [HDFC_ACCOUNT_DETAILS]
(
[ACCOUNT-NUMBER] INT ,
CUSTOMER_NAME VARCHAR(50) NOT NULL,
[PAN ID] VARCHAR(12) CHECK(LEN([PAN ID])=12) ,
[MOBILE NUMBER] BIGINT CHECK(LEN([MOBILE NUMBER])=10),
EMAIL VARCHAR(50),
PRIMARY KEY ([ACCOUNT-NUMBER],[PAN ID],[MOBILE NUMBER],EMAIL)
)
SELECT * FROM [HDFC_ACCOUNT_DETAILS]

INSERT INTO [HDFC_ACCOUNT_DETAILS] VALUES
(123654,'HARISH','LKIO2569LO12',9966403010,'HARSIAH@GOOGLE.COM')

------------------

---ALTER CONCEPTS----
---ADDING THE COLUMN TO THE TABLE
---SYNTAX:- ALTER TABLE [TABLE NAME] ADD [COLUMN NAME][DATATYPE]
SELECT * FROM [DBO].[CUSTOMER ACCOUNT DETAILS1]

adding the 3 columns to table  email,address,mobile number

ALTER TABLE [CUSTOMER ACCOUNT DETAILS1]
ADD EMAIL VARCHAR(50), [ADDRESS] VARCHAR(250),
[MOBILE NUMBER] BIGINT


---changing the datatype on the table level
--syntax:- alter table [table name] alter column [column name][new data type]

ALTER TABLE [CUSTOMER ACCOUNT DETAILS1] ALTER COLUMN [CUSTOMER-NAME] VARCHAR(50) NOT NULL

--- CHANGING THE DATATYPE OF SIZE ON TABLE LEVEL
--SYNTAX:- ALTER TABLE [TABLE NAME] ALTER COLUMN [COLUMN NAME][DATA TYPE](NEW SIZE)
ALTER TABLE [CUSTOMER ACCOUNT DETAILS1]
ALTER COLUMN [CUSTOMER-NAME] VARCHAR (200) NOT NULL


SELECT * FROM [CUSTOMER ACCOUNT DETAILS1]

---DROPING THE COLUMN ON TABLE LEVEL
--SYNTAX:- ALTER TABLE [TABLE NAME] DROP COLUMN [COLUMN NAME]
ALTER TABLE [CUSTOMER ACCOUNT DETAILS1] DROP COLUMN EMAIL,[ADDRESS]

-----------
--RENAMING THE COLUMN NAME
--SYNTAX:- SP_RENAME '[TN].[EXISTING CN]','NEW COLUMN NAME'
SP_RENAME '[CUSTOMER ACCOUNT DETAILS1].MOBILE','PHONE NUMBER'

---------------

---DROPING THE CONSTRAINTS
--SYNTAX:- ALTER TABLE [TABLE NAME] DROP CONSTRAINT [CONSTRAINT NAME]

ALTER TABLE [CUSTOMER ACCOUNT DETAILS1]
DROP CONSTRAINT [UQ__CUSTOMER__ECCCDF056DFF1282]

----ADDING THE CONSTRAINT TO TABLE LEVEL
/*SYNTAX:- ALTER TABLE [TABLE NAME] ADD CONSTRAINT [CONSTRAINT NAME]
CONSTRAINT TYPE([COLUMN NAME],[COLUMN NAME])
*/

ALTER TABLE [CUSTOMER ACCOUNT DETAILS1]
ADD CONSTRAINT UQ_AN
UNIQUE ([ACCOUNT_NUMBER])

ALTER TABLE [DBO].[HDFC_ACCOUNT_DETAILS]
DROP CONSTRAINT [PK__HDFC_ACC__31EE0FEA21C8E557]

----------------------
SELECT * FROM [CUSTOMER ACCOUNT DETAILS1]

ALTER TABLE [CUSTOMER ACCOUNT DETAILS1]
ADD CONSTRAINT [CK_PN]
CHECK (LEN([PHONE NUMBER])=10)

SP_HELP '[CUSTOMER ACCOUNT DETAILS1]'

----------------

DROP TABLE [DBO].[HDFC_ACCOUNT_DETAILS12]

CREATE TABLE [DBO].[HDFC_ACCOUNT_DETAILS12](
	[ACCOUNT-NUMBER] [INT] NOT NULL,
	[CUSTOMER_NAME] [VARCHAR](50) NOT NULL,
	[PAN ID] [VARCHAR](12)  NOT NULL,
	[MOBILE NUMBER] [BIGINT] NOT NULL,
	[EMAIL] [VARCHAR](50) NOT NULL,
	PRIMARY KEY ([ACCOUNT-NUMBER],[PAN ID]),
	UNIQUE ([MOBILE NUMBER],[EMAIL],[PAN ID])
)
GO




SP_HELP '[HDFC_ACCOUNT_DETAILS12]'

---------

SELECT * FROM ORDERS WHERE COUNTRY ='UNITED STATES' AND STATE='CALIFORNIA' and City ='Los Angeles'
and Segment = 'corporate' and [Ship Mode]= 'first class' and Profit >=100



SELECT * FROM ORDERS
WHERE COUNTRY IN('UNITED STATES') OR STATE IN ('KARNATAKA','MAHARASHTRA')
ORDER BY COUNTRY DESC



SELECT * FROM ORDERS WHERE 1=1


--------COPY (OR) REPLICA (OR) CLONE (OR) BACKUP OF TABLE-----

/*
SYNTAX:- SELECT * INTO  [DB].[SCHEMA].[NEW TN] FROM
                        [DB].[SCHEMA].[TN]
*/

SELECT * INTO ORDERS_COPY FROM ORDERS


SELECT * FROM ORDERS_COPY

-----UPDATE---
/*
UPDATE [TABLE NAME] SET [COLUMN NAME]='VALUE',[COLUMN NAME]='VALUE' WHERE CONDITION

UPDATE [TABLE NAME] SET [COLUMN NAME]='VALUE',[COLUMN NAME]='VALUE'
*/
UPDATE ORDERS_COPY SET PROFIT=0, SALES=0,Quantity=0 WHERE COUNTRY='INDIA'

UPDATE ORDERS_COPY SET PROFIT=0, SALES=0,Quantity=0, Country = null,State=null,City=null,Discount=0,[Shipping Cost]=0


SELECT * FROM ORDERS_COPY WHERE COUNTRY = 'INDIA'
SELECT * FROM ORDERS_COPY

/*
---DELETE---
DELETE FROM [TABLE NAME] WHERE CONDITION

DELETE FROM [TABLE NAME]
*/

DELETE FROM ORDERS_COPY WHERE COUNTRY = 'INDIA'

DELETE FROM ORDERS_COPY


---INSERTING THE DATA INTO TARGET TABLE from source table

ORDERS---SOURCE
ORDERS_COPY---TARGET

/*
SYNTAX:- INSERT INTO [TARGET TABLE NAME] SELECT * FROM [SOURCE TABLE NAME]
*/

INSERT INTO ORDERS_COPY SELECT * FROM ORDERS


------------------

---MERGE; INSERTION;DELETION;UPDATION----
/*
MERGE  [<<TARGET TABLE>>] AS TARGET
USING [<<SOURCE TABLE>>] AS SOURCE
ON TARGET.[<<COLUMN NAME>>]=SOURCE.[<<COLUMN NAME>>]

WHEN NOT MATCHED  BY TARGET THEN
  INSERT (<<COLUMN NAMES>>) VALUES (SOURCE.<<COLUMN NAMES>>);

*/



SELECT * FROM ORDERS_COPY
--orders---source
--orders_copy---target

MERGE  ORDERS_COPY AS TARGET
USING ORDERS AS SOURCE
ON TARGET.[ROW ID]=SOURCE.[ROW ID]

WHEN NOT MATCHED  BY TARGET THEN
  INSERT ( [Row ID]
,[Order ID]
,[Order Date]
,[Ship Date]
,[Ship Mode]
,[Customer ID]
,[Customer Name]
,[Segment]
,[City]
,[State]
,[Country]
,[Postal Code]
,[Market]
,[Region]
,[Product ID]
,[Category]
,[Sub-Category]
,[Product Name]
,[Sales]
,[Quantity]
,[Discount]
,[Profit]
,[Shipping Cost]
,[Order Priority]
  ) VALUES (

   SOURCE.[Row ID]
,SOURCE.[Order ID]
,SOURCE.[Order Date]
,SOURCE.[Ship Date]
,SOURCE.[Ship Mode]
,SOURCE.[Customer ID]
,SOURCE.[Customer Name]
,SOURCE.[Segment]
,SOURCE.[City]
,SOURCE.[State]
,SOURCE.[Country]
,SOURCE.[Postal Code]
,SOURCE.[Market]
,SOURCE.[Region]
,SOURCE.[Product ID]
,SOURCE.[Category]
,SOURCE.[Sub-Category]
,SOURCE.[Product Name]
,SOURCE.[Sales]
,SOURCE.[Quantity]
,SOURCE.[Discount]
,SOURCE.[Profit]
,SOURCE.[Shipping Cost]
,SOURCE.[Order Priority]
  );






---------------------

--MERGE UPDATION--
/*

MERGE  [<<TARGET TABLE>>] AS TARGET
USING [<<SOURCE TABLE>>] AS SOURCE
ON TARGET.[<<COLUMN NAME>>]=SOURCE.[<<COLUMN NAME>>]

WHEN MATCHED THEN UPDATE SET
     TARGET.<<COLUMN NAMES>> =SOURCE.<<COLUMN NAMES>>,
     TARGET.<<COLUMN NAMES>> = SOURCE.<<COLUMN NAMES>>;

*/
MERGE  ORDERS_COPY AS TARGET
USING ORDERS AS SOURCE
ON TARGET.[ROW ID]=SOURCE.[ROW ID]

WHEN MATCHED THEN UPDATE SET
     TARGET.COUNTRY =SOURCE.COUNTRY,
     TARGET.CITY = SOURCE.CITY,
	 TARGET.STATE=SOURCE.STATE,
	 TARGET.PROFIT=SOURCE.PROFIT,
	 TARGET.SALES=SOURCE.SALES,
	 TARGET.DISCOUNT=SOURCE.DISCOUNT,
	 TARGET.QUANTITY=SOURCE.QUANTITY,
	 TARGET.[SHIPPING COST]=SOURCE.[SHIPPING COST];



------------------

---MERGE DELETION----
/*

MERGE  [<<TARGET TABLE>>] AS TARGET
USING [<<SOURCE TABLE>>] AS SOURCE
ON TARGET.[<<COLUMN NAME>>]=SOURCE.[<<COLUMN NAME>>]
WHEN NOT MATCHED BY SOURCE THEN
DELETE;

*/


MERGE  ORDERS_COPY AS TARGET
USING ORDERS AS SOURCE
ON TARGET.COUNTRY=SOURCE.COUNTRY
WHEN NOT MATCHED BY SOURCE THEN
DELETE;



select distinct country from orders---147
select distinct country from orders_copy---144



TRUNCATE TABLE ORDERS_COPY

select * from Orders_copy

--------------------------------------------------------
SELECT DISTINCT [SHIP MODE] FROM [DBO].[ORDERS]

SELECT * FROM ORDERS WHERE [SHIP MODE] LIKE 'S%S'


SELECT * FROM ORDERS WHERE PROFIT BETWEEN 100 AND 500 AND COUNTRY LIKE 'U%S'
AND [ORDER DATE] LIKE '%2014%'
ORDER BY PROFIT

SELECT * FROM ORDERS WHERE [POSTAL CODE] IS  NULL AND COUNTRY LIKE 'UNITED STATES'

UPDATE ORDERS SET [POSTAL CODE]= 969609 WHERE STATE='VERMONT' AND [POSTAL CODE] IS NULL

SELECT DISTINCT COUNTRY FROM ORDERS WHERE [POSTAL CODE] IS  NULL

SELECT DISTINCT COUNTRY FROM ORDERS WHERE COUNTRY  LIKE 'UNITED%'

SELECT * FROM ORDERS WHERE COUNTRY NOT IN( 'UNITED STATES','UNITED KINGDOM','UNITED ARAB EMIRATES')

SELECT * FROM ORDERS WHERE COUNTRY  LIKE '%U%S%' and COUNTRY LIKE 'I%A'



----------------------------

---SUB QUERY---ONLY WILL BE USED WITH WHERE CLAUSE
SELECT * FROM ORDERS WHERE [ORDER ID] IN (
SELECT [ORDER ID] FROM RETURNS
) ORDER BY [ORDER ID]

SELECT * FROM ORDERS WHERE [ORDER ID] IN (
SELECT [ORDER ID] FROM RETURNS WHERE RETURNED = 'YES'
) AND COUNTRY IN (SELECT COUNTRY FROM COUNTRY)

CREATE TABLE COUNTRY (COUNTRY VARCHAR(50) NOT NULL)
SELECT * FROM COUNTRY

ORDER BY [ORDER ID]

SELECT TOP 60 * FROM RETURNS

SELECT * FROM RETURNS WHERE RETURNED ='NO'


UPDATE Returns set Returned = 'NO'


select * from orders where [Order ID] IN(
'IN-2014-84948'
,'CA-2012-150875'
,'MX-2014-135328'
,'CA-2014-154074'
,'CA-2012-111948'
,'MX-2014-142643'
,'CA-2014-166898'
,'US-2012-115196'
,'MX-2013-110135'
,'ID-2013-67693'
,'IN-2014-44012'
,'ES-2012-2088434'
,'CA-2013-126529'
,'IN-2012-39889'
,'IN-2013-13786'
,'ID-2011-69142'
,'IN-2014-62366'
,'MX-2013-110828'
,'IN-2012-30572'
,'ES-2014-5385720'
,'IN-2014-47848'
,'IT-2014-4273010'
,'US-2014-167178'
)

----------------------------

/*
SET OF OPERATORS

UNION :- COMBINES THE DATASET AND IT WILL BE DISTINCT RECORDS
UNION ALL:- COMBINES THE DATASET AND INCLUDES THE DUPLICATES
INTERSECT:- COMMON DATA BETSEEN THE DATASETS
EXCEPT

*/


SELECT * FROM T1---6R AND 2C
SELECT * FROM T2--6R AND 3C
SELECT * FROM T3--9R AND 2C


SELECT EID FROM T1
UNION
SELECT EID FROM T2

SELECT EID FROM T1
UNION ALL
SELECT EID FROM T2


SELECT EID FROM T1
INTERSECT
SELECT EID FROM T2
(
SELECT EID FROM T2
EXCEPT
SELECT EID FROM T1)
UNION
(
SELECT EID FROM T1
EXCEPT
SELECT EID FROM T2)



SELECT EID,ENAME FROM T1
UNION
SELECT EID,CAST(E_EXPERIENCE  AS VARCHAR(50))AS E_E  FROM T3


SELECT *,100000 AS SAL FROM T1

SELECT * FROM T2


SELECT *,100000 AS SAL FROM T1
UNION
SELECT * FROM T2


SELECT CONCAT('NAGARJUNA',' ','P')

-----------------------------------
---GROUP BY AND HAVING--- GROUP BY ONLY ON AGGRIGATE FUNCTIONS LIKE MIN,MAX,AVG,COUNT,SUM AND TO FILTER AGGRIGATE DATA USE HAVING

SELECT  COUNTRY,
        STATE,
        COUNT(DISTINCT (CITY)) AS [COUNT OF CITY],
		SUM(PROFIT) AS [TOTAL PROFIT VALUE],
		MAX(PROFIT) AS [HIGHEST PROFIT],
		MIN(PROFIT) AS [LOWEST PROFIT],
		AVG(PROFIT) AS [AVERAGE PROFIT]

FROM ORDERS

GROUP BY COUNTRY,STATE
HAVING SUM(PROFIT) >1000
ORDER BY [COUNT OF CITY] DESC

---99907.731;hp:-2461.32;lp:--686.97;avg p:-66.6495870580387

SELECT SUM(PROFIT) AS TP,MAX(PROFIT) AS HP,MIN(PROFIT) AS LP,AVG(PROFIT) AS AVG_P FROM ORDERS WHERE COUNTRY ='UNITED KINGDOM' AND STATE='ENGLAND'

UNIT TEST (LOGIC TEST)AND SMOKE TEST(DATA TRANSFORMATION CHECK)

------------------------------------------------------------------------
---SYNTAX:- SP_RENAME 'OLD TABLE NAME','NEW TABLE NAME'
SP_RENAME 'T3','TABLE3'
---SYNTAX:- SP_RENAME 'TN.OCN','NCN'

SP_RENAME 'TABLE1.EID','ENO'


------------------


SELECT * FROM [DBO].[ORDERS_COPY]
ORDER BY PROFIT DESC


SELECT * FROM ORDERS_COPY
WHERE COUNTRY = 'UNITED STATES'
ORDER BY COUNTRY DESC, STATE DESC,City DESC,PROFIT DESC


------------------------------TEMPORARY TABLES--------------

/*
LOCAL TEMPORARY TABLE :-
1.FOLLOWS WITH THE SINGLE '#'
2.LOCAL TEMP TABLE CAN'T ACCESS IN OTHER SESSIONS
3.ONCE SESSION ID GOT TERMINATES OR DISCONNECTED FROM SERVER,
LOCAL TEMP TABLE WILL BE DISAPPERED IN TEMPDB



GLOBAL TEMPORARY TABLE:-
1.FOLLOWS WITH THE SINGLE '##'

2.GLOBAL TEMP TABLE CAN ACCESS IN OTHER SESSIONS AS WELL

3.ONCE SESSION ID GOT TERMINATES OR DISCONNECTED FROM SERVER,
GLOBAL TEMP TABLE WILL BE DISAPPERED IN TEMPDB

*/

CREATE TABLE ##DUMMY
(NAMES VARCHAR(50))

INSERT INTO ##DUMMY VALUES
('JOHN'),('ERMAN'),('ELSA'),('HUNKAR')


SELECT * FROM ##DUMMY



SELECT * FROM TABLE1
SELECT * FROM TABLE2
SELECT * FROM TABLE3

---------------------
---INNER JOIN---

SELECT T1.*,T2.ESAL FROM TABLE1 AS T1 INNER JOIN TABLE2 AS T2
ON T1.ENO=T2.EID


SELECT T1.*,T2.ESAL,T3.E_EXPERIENCE

FROM TABLE1 AS T1 INNER JOIN TABLE2 AS T2
ON T1.ENO=T2.EID
INNER JOIN TABLE3 AS T3 ON T1.ENO=T3.EID

------------LEFT JOIN---------

SELECT * FROM TABLE1 AS T1
LEFT JOIN TABLE2 AS T2 ON T1.ENO=T2.EID
LEFT JOIN TABLE3 AS T3 ON T1.ENO=T3.EID

SELECT * FROM TABLE1 AS T1
LEFT JOIN TABLE2 AS T2 ON T1.ENO=T2.EID
LEFT JOIN TABLE3 AS T3 ON T2.EID=T3.EID


SELECT * FROM TABLE1
SELECT * FROM TABLE2
SELECT * FROM TABLE3


-----RIGHT JOIN----
SELECT * FROM TABLE1 AS T1 RIGHT JOIN TABLE2 AS T2
ON T1.ENO=T2.EID

SELECT * FROM TABLE1 AS T1 RIGHT JOIN TABLE2 AS T2
ON T1.ENO=T2.EID
RIGHT JOIN TABLE3 AS T3 ON T3.EID=T1.ENO

------------
SELECT * FROM TABLE1 AS T1 RIGHT JOIN TABLE2 AS T2
ON T1.ENO=T2.EID

SELECT * FROM TABLE2 AS T2 RIGHT JOIN TABLE1 AS T1
ON T1.ENO=T2.EID


-----SELF JOIN----
CREATE TABLE WIPRO (EMP_ID INT , EMP_NAME VARCHAR(20), MANAGER_ID INT)
INSERT WIPRO VALUES (1,'KRISHNA', 3),(2,'SUDEEP', 1)
INSERT WIPRO  VALUES (3,'VARDA',4)
INSERT WIPRO VALUES (4, 'BHARATH', 1),(5, 'PRIYANKA', 1)


select * from WIPRO

SELECT W1.EMP_NAME AS [EMPLOYEE NAME],
       W2.EMP_NAME AS [MANAGER NAME]
FROM WIPRO AS W1 LEFT JOIN WIPRO AS W2
ON
W1.MANAGER_ID=W2.EMP_ID


--------------------------------
select * from employee_hirerachy

SELECT * FROM EMPLOYEE_HIRERACHY WHERE EMP_ID=1000349
SELECT * FROM EMPLOYEE_HIRERACHY WHERE EMP_ID=8000490
SELECT * FROM EMPLOYEE_HIRERACHY WHERE EMP_ID=8003710
SELECT * FROM EMPLOYEE_HIRERACHY WHERE EMP_ID=8002555



-------------------------------
SELECT E1.EMP_ID AS [EMPLOYEE NUMBER],
       E1.EMP_NAME AS [EMPLOYEE NAME],
	   E2.EMP_NAME AS [L1 MANAGER NAME],
	   E3.EMP_NAME AS [L2 MANAGER NAME],
	   E4.EMP_NAME AS [L3 MANAGER NAME]
FROM
[DBO].[EMPLOYEE_HIRERACHY] AS E1 LEFT JOIN [DBO].[EMPLOYEE_HIRERACHY] AS E2 ON E1.MANAGER_ID=E2.EMP_ID
left join [EMPLOYEE_HIRERACHY] as e3 on e2.manager_id=e3.emp_id
left join [EMPLOYEE_HIRERACHY] as e4 on e3.manager_id=e4.emp_id
where e1.EMP_ID is not null
order by e1.EMP_ID
--------------------------------
select  * from [dbo].[EMPLOYEE_DETAILS]
select  * from [dbo].[EMP_REPORTING_DETAILS]
select  * from [dbo].[EMP_SAL_DETAILS]
select  * from [dbo].[EMP_PERSONAL_DETAILS]

SELECT ED.EMPLOYEE_ID AS [EMPLOYEE NUMBER] ,
       CONCAT(ED.FIRST_NAME,' , ',ED.LAST_NAME) AS [EMPLOYEE FULL NAME],
	   ERD.[MANAGER NAME],
	   ESD.HIRE_DATE AS [JOINING DATE],
	   ESD.SALARY AS [ANNUAL PACKAGE],
	   ESD.JOB_ID AS DESIGNATION,
	   EPD.PHONE_NUMBER AS [MOBILE NUMBER],
	   EPD.EMAIL
FROM
[DBO].[EMPLOYEE_DETAILS] AS ED LEFT JOIN [DBO].[EMP_REPORTING_DETAILS] AS ERD
ON ED.EMPLOYEE_ID=ERD.EMPLOYEE_ID
LEFT JOIN [DBO].[EMP_SAL_DETAILS] AS ESD ON ED.EMPLOYEE_ID=ESD.EMPLOYEE_ID
LEFT JOIN [DBO].[EMP_PERSONAL_DETAILS] AS EPD ON ED.EMPLOYEE_ID=EPD.EMPLOYEE_ID



SELECT CONCAT('MICROSOSFT','  ','GOOGLE','  ','APPLE')


---SYNTAX:- SELECT * INTO [NEW TABLE NAME] FROM [EXISTING TABLE]

----------------------------------------------------------------

SELECT  E.BUSINESSENTITYID AS [EMPLOYEE NUMBER],
        LTRIM(CONCAT(P.MIDDLENAME,' ',P.FIRSTNAME, ' , ',P.LASTNAME)) AS [FULL NAME],
		E.LOGINID,
		EA.EMAILADDRESS,
		PD.PASSWORDSALT AS [PASSWORD],
		PPN.PHONENUMBER AS [CONTACT NUMBER],
		E.NATIONALIDNUMBER AS [GOV-ID],
		E.JOBTITLE AS [EMPLOYEE DESIGNATION],
		D.DEPARTMENTID,
		D.GROUPNAME AS [GROUP OF DEPARTMENT] ,
		D.NAME AS [NAME OF THE DEPARTMENT],
		S.SHIFTID,
		S.NAME AS [SHIFT NAME],
		DATEDIFF(HOUR,S.STARTTIME,S.ENDTIME) AS [DURATION OF WORKING],
		ADT.NAME AS [BILLING TYPE],
		CR.NAME AS [COUNTRY],
		SP.NAME AS [STATE],
		A.CITY,
		CONCAT(A.ADDRESSLINE1,' , ',A.ADDRESSLINE2) AS [ADDRESS],
		A.POSTALCODE

FROM AW.[HUMANRESOURCES].[EMPLOYEE] AS E LEFT JOIN
     AW.[HUMANRESOURCES].[EMPLOYEEDEPARTMENTHISTORY] AS EDH ON E.BUSINESSENTITYID=EDH.BUSINESSENTITYID
LEFT JOIN AW.[HUMANRESOURCES].[DEPARTMENT] AS D ON EDH.DEPARTMENTID=D.DEPARTMENTID
LEFT JOIN AW.[HUMANRESOURCES].[SHIFT] AS S ON S.SHIFTID=EDH.SHIFTID
LEFT JOIN AW.[PERSON].[PERSON] AS P ON P.BUSINESSENTITYID=E.BUSINESSENTITYID
LEFT JOIN AW.[PERSON].[EMAILADDRESS] AS EA ON EA.BUSINESSENTITYID=E.BUSINESSENTITYID
LEFT JOIN AW.[PERSON].[PERSONPHONE] AS PPN ON PPN.BUSINESSENTITYID=E.BUSINESSENTITYID
LEFT JOIN AW.[PERSON].[BUSINESSENTITYADDRESS] AS BEA ON BEA.BUSINESSENTITYID=E.BUSINESSENTITYID
LEFT JOIN AW.[PERSON].[ADDRESSTYPE] AS ADT ON ADT.ADDRESSTYPEID=BEA.ADDRESSTYPEID
LEFT JOIN AW.[PERSON].[ADDRESS] AS A ON A.ADDRESSID=BEA.ADDRESSID
LEFT JOIN AW.[PERSON].[STATEPROVINCE] AS SP ON  SP.STATEPROVINCEID=A.STATEPROVINCEID
LEFT JOIN AW.[PERSON].[COUNTRYREGION] AS CR ON CR.COUNTRYREGIONCODE=SP.COUNTRYREGIONCODE
LEFT JOIN AW.PERSON.PASSWORD AS PD ON E.BUSINESSENTITYID=PD.BUSINESSENTITYID

ORDER BY E.BUSINESSENTITYID


----------------------------------

----FULL JOIN---
SELECT * FROM [DBO].[TABLE1]---6
SELECT * FROM [DBO].[TABLE2]--6
--SELECT * FROM [DBO].[TABLE3]---9


SELECT * FROM TABLE1 AS T1 FULL JOIN TABLE2 AS T2
ON T1.ENO=T2.EID
FULL JOIN TABLE3 AS T3 ON T2.EID=T3.EID

------CROSS JOIN---
SELECT * FROM TABLE1,TABLE2,TABLE3--- WHERE TABLE1.ENO=TABLE2.EID
---------------
-----MODULE 4-------
---STRING FUNCTIONS

/*
LTRIM()
RTRIM()
TRIM()
REPLACE()
LEFT()
RIGHT()
CHAINDEX()
SUBSTRING()
LEN()
REVERSE()
IIF()
ISNUMERIC()
ISNULL
COLEASE()
CAST()
CONVERT()
CONCAT()
*/

SELECT LTRIM('           APPLE LTD') AS CN
SELECT RTRIM('APPLE LTD           ') AS CN
SELECT LTRIM(RTRIM('   APPLE LTD        ') )AS CN
SELECT TRIM('   APPLE LTD     ') AS CN

---REPLACE(INPUTDATA,OLDVALUE,NEW VALUE)
SELECT REPLACE(REPLACE(REPLACE('MICROSOFT','O',9),'F','$'),'I','#') AS CN

SELECT REPLACE('    MICROSOFT IS AN AZURE CLOUD TECHOLOGY     ',' ','') AS CN

-----
SELECT LEFT('MICROSOFT IS AN AZURE',4) AS CN
SELECT RIGHT('MICROSOFT IS AN AZURE',6) AS CN
----
---CHARINDEX('FINDER POSITION','INPUTDATA')
SELECT CHARINDEX('O','ABD@MICROSOFT.COM',10)

---SUBSTRING(INPUTDATA,STRTING POSITION,LENGTH)
SELECT SUBSTRING('SATYAN@MICROSOFT.COM',1,6)
SELECT SUBSTRING('SATYAN@MICROSOFT.COM',8,13) AS SLICING

SELECT LEN('               MICROSOFT IS AN AZURE')

SELECT * INTO EMAILS FROM [AUGUST WEEKDAY BATCH]..EMAILS

SELECT * FROM EMAILS

SELECT CHARINDEX('.',EMAILS) FROM EMAILS
SELECT SUBSTRING(EMAILS,1,CHARINDEX('@',EMAILS)-1) AS NAMES,* FROM EMAILS

SELECT SUBSTRING(EMAILS,CHARINDEX('@',EMAILS)+1,LEN(EMAILS)),* FROM EMAILS



SELECT SUBSTRING(EMAILS,CHARINDEX('@',EMAILS)+1,CHARINDEX('.',EMAILS)-1) FROM EMAILS


---SUBSTRING(INPUTDATA,STRTING POSITION,LENGTH)
SELECT
SUBSTRING(EMAILS,CHARINDEX('@',EMAILS)+1, (CHARINDEX('.',EMAILS,CHARINDEX('@',EMAILS))-1-CHARINDEX('@',EMAILS)))
AS [COMPANY DOMAIN],* FROM EMAILS


select LEN('nagarjuna.p2896@gmail.com')---25
SELECT

(CHARINDEX('.',EMAILS,CHARINDEX('@',EMAILS))-1 -charindex('@',Emails) )AS [POSITION OF DOT],*
FROM EMAILS
-------------------

SELECT LTRIM('             GOOGLE') AS CN

SELECT RTRIM('        GOOGLE        ') AS CN

SELECT TRIM('      GOOGLE      ') AS CN

--DATEDIFF
--SYNTEX:-DATEDIFF(DATEPART,STARTDATE,END DATE)
SELECT DATEDIFF(HOUR,'2023-08-26 10:00:00','2023-08-26 13:45:32')

------------------------------------------------------------------------------------------
/*
LTRIM()
RTRIM()
TRIM()
REPLACE()
LEFT()
RIGHT()
CHARINDEX()
SUBSTRING()
CONCAT()
LEN()
REVERSE()
IIF()
ISNUMERIC()
ISNULL
COALEASCE()
CAST()
CONVERT()

*/
/*
REVERSE()
IIF()
ISNUMERIC()
ISNULL
COALEASCE()
CAST()
CONVERT()
*/

SELECT  REVERSE('GOOGLE')


SELECT ISNUMERIC('545435@$%$#4254bvvcg')

SELECT ISNULL([POSTAL CODE],25698)AS [PC], [POSTAL CODE],* FROM ORDERS

SELECT COUNT(*) FROM ORDERS--51290
SELECT COUNT(ISNULL([POSTAL CODE],25698)) FROM ORDERS
SELECT COALESCE(NULL,NULL,NULL,NULL,NULL,877654) AS CN

SELECT COALESCE (CAST([POSTAL CODE] AS NVARCHAR(20)),[CUSTOMER ID],'20') AS C, [POSTAL CODE],[CUSTOMER ID] FROM ORDERS


select top 10 * from orders

SELECT LEN(CAST([ROW ID] AS CHAR(20))) AS RID, LEN([ROW ID]) FROM ORDERS

SELECT CAST([ROW ID] AS CHAR(20)) AS RID INTO OD1 FROM ORDERS

SELECT CONVERT(VARCHAR(20),[ROW ID]) AS CN FROM ORDERS

SELECT IIF(1=1 ,'TRUE','FALSE')



SELECT IIF(,1000,5)



----DATE FUNCTIONS-------
/*
YEAR, YYYY, YY = YEAR
QUARTER, QQ, Q = QUARTER
MONTH, MM, M = MONTH
DAYOFYEAR, DY, Y = DAY OF THE YEAR
DAY, DD, D = DAY OF THE MONTH
WEEK, WW, WK = WEEK
WEEKDAY, DW, W = WEEKDAY
HOUR, HH = HOUR
MINUTE, MI, N = MINUTE
SECOND, SS, S = SECOND
MILLISECOND, MS = MILLISECOND
MICROSECOND, MCS = MICROSECOND
NANOSECOND, NS = NANOSECOND
*/

SELECT GETDATE() AS D---DEPENDS ON THE SERVER
SELECT GETUTCDATE() AS D----PROVIDES THE UK TIME
SELECT SYSDATETIME() AS D---DEPENDS ON THE SYSTEM

---DATEADD(DATEPART,INTERVAL,DATE)
select DATEADD(HOUR,-5,GETDATE()) as d
select DATEADD(DAY,5,GETDATE()) as d
select DATEADD(MONTH,-5,GETDATE()) as d
SELECT DATEADD(YEAR,5,GETDATE()) AS D
SELECT DATEADD(DAY,5,'2023-08-12') AS D
-------
SELECT YEAR(GETDATE()) AS D
SELECT MONTH(GETDATE()) AS D
SELECT day(GETDATE()) AS D

---eomonth
SELECT EOMONTH('2023-07-12')

----------------
---DATEDIFF(DATEPART,STARTDATE,ENDDATE)
SELECT DATEDIFF(MONTH,'2023-07-26',GETDATE())


SELECT * FROM ORDERS

SELECT DATENAME(WEEKDAY,'1996-06-28')

SELECT DATENAME(QQ,GETDATE())


select format(getdate(),'MM-yyyy-dd')


SELECT CONCAT(
YEAR(GETDATE()),' / ',UPPER(LEFT(DATENAME(MONTH,GETDATE()),3)),' / ',DAY(GETDATE())
)

SELECT ISDATE(format(getdate(),'MM-yyyy-dd'))

select format(getdate(),'MMM-yyyy-dd')


/*
IF CONDITION
PRINT VALUE
ELSE
PRINT VALUE
*/

IF 1=2
PRINT 'WORKING'
ELSE
PRINT 'ISSUE'

IF 1=2
PRINT '1ST BLOCK  IS WORKING'
ELSE IF 1=3
PRINT '2ND BLOCK IS WORKING'
ELSE IF 1=0
PRINT 'BLOCK 3 IS WORKING'
ELSE
PRINT 'ISSUE'


/*
DECLARE @VARIABLENAME AS DATATYPE
SET @VARIABLENAME = VALUE


*/

DECLARE @I AS INT, @C AS NVARCHAR(50)
SET @I=500
SET @C='UNITED STATES'
SELECT * FROM ORDERS WHERE PROFIT >@I AND Country=@C

--

DUBAI,UNITED STATES,AUSTRALIA,SINGAPORE



DECLARE @C AS VARCHAR(50)
SET @C='Singapore'
IF @C='AUSTRALIA'
PRINT CONCAT(@C,' TIME ZONE IS'  ,DATEADD(HOUR,10,GETUTCDATE()))
ELSE IF @C='DUBAI'
PRINT CONCAT(@C,' TIME ZONE IS '  ,DATEADD(HOUR,4,GETUTCDATE()))
ELSE IF @C='SINGAPORE'
PRINT CONCAT(@C,' TIME ZONE IS'  ,DATEADD(HOUR,8,GETUTCDATE()))
ELSE IF @C='UNITED STATES'
PRINT CONCAT(@C,' TIME ZONE IS'  ,DATEADD(HOUR,-4,GETUTCDATE()))
ELSE
PRINT CONCAT(@C ,' TIME ZONE IS NOT AVAILABLE')


select GETUTCDATE()


SELECT DISTINCT(YEAR([ORDER DATE])) FROM ORDERS


IF DATENAME(WEEKDAY,GETDATE())=DATENAME(WEEKDAY,GETDATE())
SELECT * FROM ORDERS WHERE DATENAME(WEEKDAY,[ORDER DATE])=DATENAME(WEEKDAY,GETDATE())
ORDER BY [ORDER DATE]
ELSE
PRINT 'NO DATA'
SELECT * FROM ORDERS WHERE DATENAME(WEEKDAY,[ORDER DATE])=DATENAME(WEEKDAY,GETDATE())

SELECT * FROM ORDERS WHERE DATENAME(WEEKDAY,[ORDER DATE])='WEDNESDAY'
ORDER BY [ORDER DATE]

---CASE CONDITIONS
/*
(
CASE WHEN CONDITION THEN EXPRESSION
     WHEN CONDITION THEN EXPRESSION
     WHEN CONDITION THEN EXPRESSION
     WHEN CONDITION THEN EXPRESSION
     WHEN CONDITION THEN EXPRESSION
     ELSE EXPRESSION
END
)
*/


SELECT (
CASE WHEN PROFIT>0 THEN 'PROFIT'
     WHEN PROFIT<0 THEN 'LOSS'
	 ELSE 'NO LOSS & NO PROFIT'
END
) AS SUMMARY,PROFIT, [PRODUCT NAME],COUNTRY,STATE,CITY FROM ORDERS --WHERE PROFIT =0

SELECT distinct YEAR(hire_date) FROM [DBO].[EMP_SAL_DETAILS]
select * from  [DBO].[EMP_SAL_DETAILS]
UPDATE EMP_SAL_DETAILS SET HIRE_DATE=DATEADD(YEAR,12,HIRE_DATE)



SELECT (
CASE WHEN DATEDIFF(YEAR,HIRE_DATE,GETDATE())>10 THEN SALARY+SALARY*0.35
     WHEN DATEDIFF(YEAR,HIRE_DATE,GETDATE())>=7 AND DATEDIFF(YEAR,HIRE_DATE,GETDATE())<=10 THEN SALARY+SALARY*0.30
	 WHEN DATEDIFF(YEAR,HIRE_DATE,GETDATE())>=4 AND DATEDIFF(YEAR,HIRE_DATE,GETDATE())<7
	 THEN SALARY+SALARY*0.25
	 ELSE SALARY+SALARY*0.15

END
) AS HIKE_SALARY,* FROM EMP_SAL_DETAILS

UPDATE EMP_SAL_DETAILS SET SALARY=(
CASE WHEN DATEDIFF(YEAR,HIRE_DATE,GETDATE())>10 THEN SALARY+SALARY*0.35
     WHEN DATEDIFF(YEAR,HIRE_DATE,GETDATE())>=7 AND DATEDIFF(YEAR,HIRE_DATE,GETDATE())<=10 THEN SALARY+SALARY*0.30
	 WHEN DATEDIFF(YEAR,HIRE_DATE,GETDATE())>=4 AND DATEDIFF(YEAR,HIRE_DATE,GETDATE())<7
	 THEN SALARY+SALARY*0.25
	 ELSE SALARY+SALARY*0.15

END
)


SELECT * FROM EMP_SAL_DETAILS

select * from ORDERS_COPY


UPDATE ORDERS_COPY SET COUNTRY = (
CASE WHEN COUNTRY='US'  then 'UNITED STATES'
     WHEN COUNTRY='AU' then'AUSTRALIA'

END )


SELECT  (
CASE WHEN COUNTRY='UNITED STATES' THEN 'US' WHEN COUNTRY='AUSTRALIA' THEN 'AU' WHEN COUNTRY='GERMANY' THEN 'DE' WHEN COUNTRY='NEW ZEALAND' THEN 'NZ' WHEN COUNTRY='UNITED KINGDOM' THEN 'UK' WHEN COUNTRY='INDIA' THEN 'IN' ELSE COUNTRY END ) AS NC, * FROM ORDERS



SELECT * FROM ORDERS_COPY

---WHILE LOOPS---
/*
DECLARE @N AS INT
SET @N = VALUES
WHILE CONDITION
BEGIN

LOGIC

END
*/

DECLARE @D AS INT
SET @D=0
WHILE @D<=6
BEGIN

PRINT DATENAME(WEEKDAY,DATEADD(DAY,@D,GETDATE()))
SET @D=@D+1

END

DECLARE @D AS INT
SET @D=1
WHILE @D<=7
BEGIN

PRINT DATENAME(WEEKDAY,DATEADD(DAY,@D,GETDATE()))
SET @D=@D+1

END
--------------------------------------------------------------
```
